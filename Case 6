P<X,d,W>:=ProjectiveSpace(Rationals(),2);
PC61:=Curve(P, X^18*d^3 + 21*X^18*d^2*W - 144*X^17*d^3*W + 207*X^16*d^4*W + 35*X^18*d*W^2 -
    672*X^17*d^2*W^2 + 3915*X^16*d^3*W^2 - 8256*X^15*d^4*W^2 + 5364*X^14*d^5*W^2
    + 7*X^18*W^3 - 336*X^17*d*W^3 + 5229*X^16*d^2*W^3 - 32768*X^15*d^3*W^3 +
    89028*X^14*d^4*W^3 - 101376*X^13*d^5*W^3 + 38172*X^12*d^6*W^3 +
    441*X^16*d*W^4 - 11200*X^15*d^2*W^4 + 94812*X^14*d^3*W^4 -
    342912*X^13*d^4*W^4 + 560076*X^12*d^5*W^4 - 389952*X^11*d^6*W^4 +
    88974*X^10*d^7*W^4 + 6636*X^14*d^2*W^5 - 104064*X^13*d^3*W^5 +
    553300*X^12*d^4*W^5 - 1271808*X^11*d^5*W^5 + 1321830*X^10*d^6*W^5 -
    582560*X^9*d^7*W^5 + 85794*X^8*d^8*W^5 + 36548*X^12*d^3*W^6 -
    374976*X^11*d^4*W^6 + 1303914*X^10*d^5*W^6 - 1946560*X^9*d^6*W^6 +
    1303914*X^8*d^7*W^6 - 374976*X^7*d^8*W^6 + 36548*X^6*d^9*W^6 +
    85794*X^10*d^4*W^7 - 582560*X^9*d^5*W^7 + 1321830*X^8*d^6*W^7 -
    1271808*X^7*d^7*W^7 + 553300*X^6*d^8*W^7 - 104064*X^5*d^9*W^7 +
    6636*X^4*d^10*W^7 + 88974*X^8*d^5*W^8 - 389952*X^7*d^6*W^8 +
    560076*X^6*d^7*W^8 - 342912*X^5*d^8*W^8 + 94812*X^4*d^9*W^8 -
    11200*X^3*d^10*W^8 + 441*X^2*d^11*W^8 + 38172*X^6*d^6*W^9 -
    101376*X^5*d^7*W^9 + 89028*X^4*d^8*W^9 - 32768*X^3*d^9*W^9 +
    5229*X^2*d^10*W^9 - 336*X*d^11*W^9 + 7*d^12*W^9 + 5364*X^4*d^7*W^10 -
    8256*X^3*d^8*W^10 + 3915*X^2*d^9*W^10 - 672*X*d^10*W^10 + 35*d^11*W^10 +
    207*X^2*d^8*W^11 - 144*X*d^9*W^11 + 21*d^10*W^11 + d^9*W^12);
PC62:=Curve(P, X^36*d^6 + 186*X^36*d^5*W - 1152*X^35*d^6*W + 1710*X^34*d^7*W +
    1423*X^36*d^4*W^2 - 22656*X^35*d^5*W^2 + 117612*X^34*d^6*W^2 -
    242304*X^33*d^7*W^2 + 167193*X^32*d^8*W^2 + 1772*X^36*d^3*W^3 -
    66048*X^35*d^4*W^3 + 775602*X^34*d^5*W^3 - 4014208*X^33*d^6*W^3 +
    10031274*X^32*d^7*W^3 - 11642112*X^31*d^8*W^3 + 4929360*X^30*d^9*W^3 +
    655*X^36*d^2*W^4 - 47616*X^35*d^3*W^4 + 1161576*X^34*d^4*W^4 -
    12403712*X^33*d^5*W^4 + 67017207*X^32*d^6*W^4 - 194535168*X^31*d^7*W^4 +
    302334240*X^30*d^8*W^4 - 232936704*X^29*d^9*W^4 + 68866164*X^28*d^10*W^4 +
    58*X^36*d*W^5 - 9600*X^35*d^2*W^5 + 474930*X^34*d^3*W^5 -
    10213376*X^33*d^4*W^5 + 108866316*X^32*d^5*W^5 - 631736832*X^31*d^6*W^5 +
    2097325232*X^30*d^7*W^5 - 4029619968*X^29*d^8*W^5 + 4360432968*X^28*d^9*W^5
    - 2431846144*X^27*d^10*W^5 + 536728584*X^26*d^11*W^5 + X^36*W^6 -
    384*X^35*d*W^6 + 48492*X^34*d^2*W^6 - 2272640*X^33*d^3*W^6 +
    49603575*X^32*d^4*W^6 - 562607616*X^31*d^5*W^6 + 3599585216*X^30*d^6*W^6 -
    13649213952*X^29*d^7*W^6 + 31327273932*X^28*d^8*W^6 -
    43320144128*X^27*d^9*W^6 + 34804009680*X^26*d^10*W^6 -
    14771494656*X^25*d^11*W^6 + 2529961732*X^24*d^12*W^6 + 558*X^34*d*W^7 -
    99200*X^33*d^2*W^7 + 5519658*X^32*d^3*W^7 - 137167104*X^31*d^4*W^7 +
    1759218608*X^30*d^5*W^7 - 12796134912*X^29*d^6*W^7 +
    55920596208*X^28*d^7*W^7 - 151399789056*X^27*d^8*W^7 +
    256347705720*X^26*d^9*W^7 - 268240806144*X^25*d^10*W^7 +
    166393527272*X^24*d^11*W^7 - 55396339968*X^23*d^12*W^7 +
    7533567024*X^22*d^13*W^7 + 69657*X^32*d^2*W^8 - 6470400*X^31*d^3*W^8 +
    211899680*X^30*d^4*W^8 - 3316490496*X^29*d^5*W^8 + 28588838604*X^28*d^6*W^8
    - 146846105088*X^27*d^7*W^8 + 469738708320*X^26*d^8*W^8 -
    956349762048*X^25*d^9*W^8 + 1243558987324*X^24*d^10*W^8 -
    1016037962496*X^23*d^11*W^8 + 498498301920*X^22*d^12*W^8 -
    132538827008*X^21*d^13*W^8 + 14492375406*X^20*d^14*W^8 +
    2863696*X^30*d^3*W^9 - 167701248*X^29*d^4*W^9 + 3628195656*X^28*d^5*W^9 -
    39525967616*X^27*d^6*W^9 + 246940522104*X^26*d^7*W^9 -
    947002222080*X^25*d^8*W^9 + 2313098770864*X^24*d^9*W^9 -
    3659419193856*X^23*d^10*W^9 + 3748492657104*X^22*d^11*W^9 -
    2437865853696*X^21*d^12*W^9 + 959225708268*X^20*d^13*W^9 -
    205515552768*X^19*d^14*W^9 + 18149952788*X^18*d^15*W^9 +
    52149108*X^28*d^4*W^10 - 2087022848*X^27*d^5*W^10 +
    32301598416*X^26*d^6*W^10 - 260466644736*X^25*d^7*W^10 +
    1234764930364*X^24*d^8*W^10 - 3661160050176*X^23*d^9*W^10 +
    7015556687424*X^22*d^10*W^10 - 8805146845696*X^21*d^11*W^10 +
    7214546392434*X^20*d^12*W^10 - 3773890884096*X^19*d^13*W^10 +
    1197917612936*X^18*d^14*W^10 - 207163603968*X^17*d^15*W^10 +
    14739583086*X^16*d^16*W^10 + 480089352*X^26*d^5*W^11 -
    14067562752*X^25*d^6*W^11 + 164048984552*X^24*d^7*W^11 -
    1017460198656*X^23*d^8*W^11 + 3768176270544*X^22*d^9*W^11 -
    8833971314176*X^21*d^10*W^11 + 13504952139624*X^20*d^11*W^11 -
    13607656951296*X^19*d^12*W^11 + 8984387793964*X^18*d^13*W^11 -
    3791908164096*X^17*d^14*W^11 + 970052768748*X^16*d^15*W^11 -
    134721920768*X^15*d^16*W^11 + 7651474224*X^14*d^17*W^11 +
    2476697092*X^24*d^6*W^12 - 55520456448*X^23*d^7*W^12 +
    503724372960*X^22*d^8*W^12 - 2461884124416*X^21*d^9*W^12 +
    7255035194994*X^20*d^10*W^12 - 13629210917376*X^19*d^11*W^12 +
    16770843469424*X^18*d^12*W^12 - 13629210917376*X^17*d^13*W^12 +
    7255035194994*X^16*d^14*W^12 - 2461884124416*X^15*d^15*W^12 +
    503724372960*X^14*d^16*W^12 - 55520456448*X^13*d^17*W^12 +
    2476697092*X^12*d^18*W^12 + 7651474224*X^22*d^7*W^13 -
    134721920768*X^21*d^8*W^13 + 970052768748*X^20*d^9*W^13 -
    3791908164096*X^19*d^10*W^13 + 8984387793964*X^18*d^11*W^13 -
    13607656951296*X^17*d^12*W^13 + 13504952139624*X^16*d^13*W^13 -
    8833971314176*X^15*d^14*W^13 + 3768176270544*X^14*d^15*W^13 -
    1017460198656*X^13*d^16*W^13 + 164048984552*X^12*d^17*W^13 -
    14067562752*X^11*d^18*W^13 + 480089352*X^10*d^19*W^13 +
    14739583086*X^20*d^8*W^14 - 207163603968*X^19*d^9*W^14 +
    1197917612936*X^18*d^10*W^14 - 3773890884096*X^17*d^11*W^14 +
    7214546392434*X^16*d^12*W^14 - 8805146845696*X^15*d^13*W^14 +
    7015556687424*X^14*d^14*W^14 - 3661160050176*X^13*d^15*W^14 +
    1234764930364*X^12*d^16*W^14 - 260466644736*X^11*d^17*W^14 +
    32301598416*X^10*d^18*W^14 - 2087022848*X^9*d^19*W^14 +
    52149108*X^8*d^20*W^14 + 18149952788*X^18*d^9*W^15 -
    205515552768*X^17*d^10*W^15 + 959225708268*X^16*d^11*W^15 -
    2437865853696*X^15*d^12*W^15 + 3748492657104*X^14*d^13*W^15 -
    3659419193856*X^13*d^14*W^15 + 2313098770864*X^12*d^15*W^15 -
    947002222080*X^11*d^16*W^15 + 246940522104*X^10*d^17*W^15 -
    39525967616*X^9*d^18*W^15 + 3628195656*X^8*d^19*W^15 -
    167701248*X^7*d^20*W^15 + 2863696*X^6*d^21*W^15 + 14492375406*X^16*d^10*W^16
    - 132538827008*X^15*d^11*W^16 + 498498301920*X^14*d^12*W^16 -
    1016037962496*X^13*d^13*W^16 + 1243558987324*X^12*d^14*W^16 -
    956349762048*X^11*d^15*W^16 + 469738708320*X^10*d^16*W^16 -
    146846105088*X^9*d^17*W^16 + 28588838604*X^8*d^18*W^16 -
    3316490496*X^7*d^19*W^16 + 211899680*X^6*d^20*W^16 - 6470400*X^5*d^21*W^16 +
    69657*X^4*d^22*W^16 + 7533567024*X^14*d^11*W^17 - 55396339968*X^13*d^12*W^17
    + 166393527272*X^12*d^13*W^17 - 268240806144*X^11*d^14*W^17 +
    256347705720*X^10*d^15*W^17 - 151399789056*X^9*d^16*W^17 +
    55920596208*X^8*d^17*W^17 - 12796134912*X^7*d^18*W^17 +
    1759218608*X^6*d^19*W^17 - 137167104*X^5*d^20*W^17 + 5519658*X^4*d^21*W^17 -
    99200*X^3*d^22*W^17 + 558*X^2*d^23*W^17 + 2529961732*X^12*d^12*W^18 -
    14771494656*X^11*d^13*W^18 + 34804009680*X^10*d^14*W^18 -
    43320144128*X^9*d^15*W^18 + 31327273932*X^8*d^16*W^18 -
    13649213952*X^7*d^17*W^18 + 3599585216*X^6*d^18*W^18 -
    562607616*X^5*d^19*W^18 + 49603575*X^4*d^20*W^18 - 2272640*X^3*d^21*W^18 +
    48492*X^2*d^22*W^18 - 384*X*d^23*W^18 + d^24*W^18 + 536728584*X^10*d^13*W^19
    - 2431846144*X^9*d^14*W^19 + 4360432968*X^8*d^15*W^19 -
    4029619968*X^7*d^16*W^19 + 2097325232*X^6*d^17*W^19 -
    631736832*X^5*d^18*W^19 + 108866316*X^4*d^19*W^19 - 10213376*X^3*d^20*W^19 +
    474930*X^2*d^21*W^19 - 9600*X*d^22*W^19 + 58*d^23*W^19 +
    68866164*X^8*d^14*W^20 - 232936704*X^7*d^15*W^20 + 302334240*X^6*d^16*W^20 -
    194535168*X^5*d^17*W^20 + 67017207*X^4*d^18*W^20 - 12403712*X^3*d^19*W^20 +
    1161576*X^2*d^20*W^20 - 47616*X*d^21*W^20 + 655*d^22*W^20 +
    4929360*X^6*d^15*W^21 - 11642112*X^5*d^16*W^21 + 10031274*X^4*d^17*W^21 -
    4014208*X^3*d^18*W^21 + 775602*X^2*d^19*W^21 - 66048*X*d^20*W^21 +
    1772*d^21*W^21 + 167193*X^4*d^16*W^22 - 242304*X^3*d^17*W^22 +
    117612*X^2*d^18*W^22 - 22656*X*d^19*W^22 + 1423*d^20*W^22 +
    1710*X^2*d^17*W^23 - 1152*X*d^18*W^23 + 186*d^19*W^23 + d^18*W^24);
GenusViaArithmeticGenus(PC62);
SingularPoints(PC62);
SingularPoints(PC61);
Genus(PC61);

433
{@ (0 : 0 : 1), (1 : 1 : 1), (0 : 1 : 0), (1 : 0 : 0) @}
{@ (0 : 0 : 1), (1 : 1 : 1), (0 : 1 : 0), (1 : 0 : 0) @}
0


K:=FieldOfGeometricIrreducibility(PC61);
K;

Number Field with defining polynomial $.1^3 - 300331213700085757/8192*$.1^2 +
    30066274759538943328581129689337859/67108864*$.1 -
    1003315339786918143908976827540979875338233546946559/549755813888 over the
Rational Field

> R<X> := PolynomialRing(Rationals());
> f := X^3 - 300331213700085757/8192*X^2 +
>     30066274759538943328581129689337859/67108864*X -
>     1003315339786918143908976827540979875338233546946559/549755813888;
> k := NumberField(f);
> P<X,d,W>:=ProjectiveSpace(k,2);
> PC61:=Curve(P, X^18*d^3 + 21*X^18*d^2*W - 144*X^17*d^3*W + 207*X^16*d^4*W + 35*X^18*d*W^2 -
>     672*X^17*d^2*W^2 + 3915*X^16*d^3*W^2 - 8256*X^15*d^4*W^2 + 5364*X^14*d^5*W^2
>     + 7*X^18*W^3 - 336*X^17*d*W^3 + 5229*X^16*d^2*W^3 - 32768*X^15*d^3*W^3 +
>     89028*X^14*d^4*W^3 - 101376*X^13*d^5*W^3 + 38172*X^12*d^6*W^3 +
>     441*X^16*d*W^4 - 11200*X^15*d^2*W^4 + 94812*X^14*d^3*W^4 -
>     342912*X^13*d^4*W^4 + 560076*X^12*d^5*W^4 - 389952*X^11*d^6*W^4 +
>     88974*X^10*d^7*W^4 + 6636*X^14*d^2*W^5 - 104064*X^13*d^3*W^5 +
>     553300*X^12*d^4*W^5 - 1271808*X^11*d^5*W^5 + 1321830*X^10*d^6*W^5 -
>     582560*X^9*d^7*W^5 + 85794*X^8*d^8*W^5 + 36548*X^12*d^3*W^6 -
>     374976*X^11*d^4*W^6 + 1303914*X^10*d^5*W^6 - 1946560*X^9*d^6*W^6 +
>     1303914*X^8*d^7*W^6 - 374976*X^7*d^8*W^6 + 36548*X^6*d^9*W^6 +
>     85794*X^10*d^4*W^7 - 582560*X^9*d^5*W^7 + 1321830*X^8*d^6*W^7 -
>     1271808*X^7*d^7*W^7 + 553300*X^6*d^8*W^7 - 104064*X^5*d^9*W^7 +
>     6636*X^4*d^10*W^7 + 88974*X^8*d^5*W^8 - 389952*X^7*d^6*W^8 +
>     560076*X^6*d^7*W^8 - 342912*X^5*d^8*W^8 + 94812*X^4*d^9*W^8 -
>     11200*X^3*d^10*W^8 + 441*X^2*d^11*W^8 + 38172*X^6*d^6*W^9 -
>     101376*X^5*d^7*W^9 + 89028*X^4*d^8*W^9 - 32768*X^3*d^9*W^9 +
>     5229*X^2*d^10*W^9 - 336*X*d^11*W^9 + 7*d^12*W^9 + 5364*X^4*d^7*W^10 -
>     8256*X^3*d^8*W^10 + 3915*X^2*d^9*W^10 - 672*X*d^10*W^10 + 35*d^11*W^10 +
>     207*X^2*d^8*W^11 - 144*X*d^9*W^11 + 21*d^10*W^11 + d^9*W^12);
> IrreducibleComponents(PC61);
[
    Scheme over k defined by
    X^6*d + 1/4717550913899258251191517184*(-1275068416*k.1^2 + 31164019050908814622720*k.1 - 190420296074874355379039268331294739)*X^6*W +
        1/2358775456949629125595758592*(3825205248*k.1^2 - 93492057152726443868160*k.1 + 571260874071970324439343051419332665)*X^5*d*W +
        1/4717550913899258251191517184*(-11475615744*k.1^2 + 280476171458179331604480*k.1 - 1713782636368563715015803907832549547)*X^4*d^2*W +
        1/2358775456949629125595758592*(-3825205248*k.1^2 + 93492057152726443868160*k.1 - 571260866995643953590455674632056889)*X^4*d*W^2 +
        1/1179387728474814562797879296*(6375342080*k.1^2 - 155820095254544073113600*k.1 + 952101456786617207398905085698887775)*X^3*d^2*W^2 +
        1/2358775456949629125595758592*(-3825205248*k.1^2 + 93492057152726443868160*k.1 - 571260866995643953590455674632056889)*X^2*d^3*W^2 +
        1/4717550913899258251191517184*(-11475615744*k.1^2 + 280476171458179331604480*k.1 - 1713782636368563715015803907832549547)*X^2*d^2*W^3 +
        1/2358775456949629125595758592*(3825205248*k.1^2 - 93492057152726443868160*k.1 + 571260874071970324439343051419332665)*X*d^3*W^3 +
        1/4717550913899258251191517184*(-1275068416*k.1^2 + 31164019050908814622720*k.1 - 190420296074874355379039268331294739)*d^4*W^3 + d^3*W^4,
    Scheme over k defined by
    X^6*d + 1/589693864237407281398939648*(67108864*k.1^2 - 1640870769462043721728*k.1 + 10030182965591011168476046123771905)*X^6*W +
        1/294846932118703640699469824*(-201326592*k.1^2 + 4922612308386131165184*k.1 - 30090550665854626217649982568134659)*X^5*d*W +
        1/589693864237407281398939648*(603979776*k.1^2 - 14767836925158393495552*k.1 + 90271650228482285940728103507585033)*X^4*d^2*W +
        1/294846932118703640699469824*(201326592*k.1^2 - 4922612308386131165184*k.1 + 30090551550395422573760904666544131)*X^4*d*W^2 +
        1/147423466059351820349734912*(-335544320*k.1^2 + 8204353847310218608640*k.1 - 50150917776424377029416637613557765)*X^3*d^2*W^2 +
        1/294846932118703640699469824*(201326592*k.1^2 - 4922612308386131165184*k.1 + 30090551550395422573760904666544131)*X^2*d^3*W^2 +
        1/589693864237407281398939648*(603979776*k.1^2 - 14767836925158393495552*k.1 + 90271650228482285940728103507585033)*X^2*d^2*W^3 +
        1/294846932118703640699469824*(-201326592*k.1^2 + 4922612308386131165184*k.1 - 30090550665854626217649982568134659)*X*d^3*W^3 +
        1/589693864237407281398939648*(67108864*k.1^2 - 1640870769462043721728*k.1 + 10030182965591011168476046123771905)*d^4*W^3 + d^3*W^4,
    Scheme over k defined by
    X^6*d + 1/4717550913899258251191517184*(738197504*k.1^2 - 18037052895212464848896*k.1 + 110178931418715457915654174362980363)*X^6*W +
        1/2358775456949629125595758592*(-2214592512*k.1^2 + 54111158685637394546688*k.1 - 330536808408799115444737276663492641)*X^5*d*W +
        1/4717550913899258251191517184*(6643777536*k.1^2 - 162333476056912183640064*k.1 + 991610411073744604636437076415926371)*X^4*d^2*W +
        1/2358775456949629125595758592*(2214592512*k.1^2 - 54111158685637394546688*k.1 + 330536815485125486293624653450768417)*X^4*d*W^2 +
        1/1179387728474814562797879296*(-3690987520*k.1^2 + 90185264476062324244480*k.1 - 550894680681331859074562127772487735)*X^3*d^2*W^2 +
        1/2358775456949629125595758592*(2214592512*k.1^2 - 54111158685637394546688*k.1 + 330536815485125486293624653450768417)*X^2*d^3*W^2 +
        1/4717550913899258251191517184*(6643777536*k.1^2 - 162333476056912183640064*k.1 + 991610411073744604636437076415926371)*X^2*d^2*W^3 +
        1/2358775456949629125595758592*(-2214592512*k.1^2 + 54111158685637394546688*k.1 - 330536808408799115444737276663492641)*X*d^3*W^3 +
        1/4717550913899258251191517184*(738197504*k.1^2 - 18037052895212464848896*k.1 + 110178931418715457915654174362980363)*d^4*W^3 + d^3*W^4
]

For the first Scheme

function collect(f, i)
    R := Parent(f);
    K := BaseRing(R);
    n := Rank(R);

    // Check if i is within valid range (manual error handling)
    if i lt 1 or i gt n then
        error "Variable index out of bounds";
    end if;

    // Indices of the other variables
    others := [1..n];
    Remove(~others, i);

    // Create the coefficient ring with the other variables
    Snames := [Names(R)[j] : j in others];
    S := PolynomialRing(K, #others);
    AssignNames(~S, Snames);

    // Create the univariate ring over S for the i-th variable
    S1<y> := PolynomialRing(S);
    AssignNames(~S1, [Names(R)[i]]);

    // Define the homomorphism from R to S1
    hom_images := [];
    for j in [1..n] do
        if j eq i then
            Append(~hom_images, S1.1); // y (the i-th variable)
        else
            pos := Index(others, j);
            Append(~hom_images, S.pos); // Other variables mapped to S
        end if;
    end for;

    hom := hom< R -> S1 | hom_images >;

    // Map the polynomial to the new ring
    g := hom(f);
    return g, S1;
end function;

K := Rationals();
R<k, X, d, W> := PolynomialRing(K, 4);
f :=X^6*d + 1/4717550913899258251191517184*(-1275068416*k^2 + 31164019050908814622720*k - 190420296074874355379039268331294739)*X^6*W +
        1/2358775456949629125595758592*(3825205248*k^2 - 93492057152726443868160*k + 571260874071970324439343051419332665)*X^5*d*W +
        1/4717550913899258251191517184*(-11475615744*k^2 + 280476171458179331604480*k - 1713782636368563715015803907832549547)*X^4*d^2*W +
        1/2358775456949629125595758592*(-3825205248*k^2 + 93492057152726443868160*k - 571260866995643953590455674632056889)*X^4*d*W^2 +
        1/1179387728474814562797879296*(6375342080*k^2 - 155820095254544073113600*k + 952101456786617207398905085698887775)*X^3*d^2*W^2 +
        1/2358775456949629125595758592*(-3825205248*k^2 + 93492057152726443868160*k - 571260866995643953590455674632056889)*X^2*d^3*W^2 +
        1/4717550913899258251191517184*(-11475615744*k^2 + 280476171458179331604480*k - 1713782636368563715015803907832549547)*X^2*d^2*W^3 +
        1/2358775456949629125595758592*(3825205248*k^2 - 93492057152726443868160*k + 571260874071970324439343051419332665)*X*d^3*W^3 +
        1/4717550913899258251191517184*(-1275068416*k^2 + 31164019050908814622720*k - 190420296074874355379039268331294739)*d^4*W^3 + d^3*W^4;
// Collect terms with respect to x (first variable)
g, S1 := collect(f, 1);

// Output will be:
// (y + 3)*y^2 + (z)*y + 2*z
// Where y in S1 represents the original x variable
g, S1;
(-19/70296986608196172881*X^6*W + 114/70296986608196172881*X^5*d*W -
    171/70296986608196172881*X^4*d^2*W - 114/70296986608196172881*X^4*d*W^2 +
    380/70296986608196172881*X^3*d^2*W^2 - 114/70296986608196172881*X^2*d^3*W^2
    - 171/70296986608196172881*X^2*d^2*W^3 + 114/70296986608196172881*X*d^3*W^3
    - 19/70296986608196172881*d^4*W^3)*k^2 + (6733690045/1019333404135424*X^6*W
    - 20201070135/509666702067712*X^5*d*W +
    60603210405/1019333404135424*X^4*d^2*W +
    20201070135/509666702067712*X^4*d*W^2 -
    33668450225/254833351033856*X^3*d^2*W^2 +
    20201070135/509666702067712*X^2*d^3*W^2 +
    60603210405/1019333404135424*X^2*d^2*W^3 -
    20201070135/509666702067712*X*d^3*W^3 +
    6733690045/1019333404135424*d^4*W^3)*k + X^6*d -
    2386450528484026739/59122909184*X^6*W +
    7159351408083352665/29561454592*X^5*d*W -
    21478054401618785547/59122909184*X^4*d^2*W -
    7159351319398988889/29561454592*X^4*d*W^2 +
    11932252346805587775/14780727296*X^3*d^2*W^2 -
    7159351319398988889/29561454592*X^2*d^3*W^2 -
    21478054401618785547/59122909184*X^2*d^2*W^3 +
    7159351408083352665/29561454592*X*d^3*W^3 -
    2386450528484026739/59122909184*d^4*W^3 + d^3*W^4
Univariate Polynomial Ring in k over Polynomial ring of rank 3 over Rational
    Field

P<X,d,W>:=ProjectiveSpace(Rationals(),2);
S1 := Scheme(P, [(-19/70296986608196172881*X^6*W + 114/70296986608196172881*X^5*d*W -
    171/70296986608196172881*X^4*d^2*W - 114/70296986608196172881*X^4*d*W^2 +
    380/70296986608196172881*X^3*d^2*W^2 - 114/70296986608196172881*X^2*d^3*W^2
    - 171/70296986608196172881*X^2*d^2*W^3 + 114/70296986608196172881*X*d^3*W^3
    - 19/70296986608196172881*d^4*W^3),
(6733690045/1019333404135424*X^6*W
    - 20201070135/509666702067712*X^5*d*W +
    60603210405/1019333404135424*X^4*d^2*W +
    20201070135/509666702067712*X^4*d*W^2 -
    33668450225/254833351033856*X^3*d^2*W^2 +
    20201070135/509666702067712*X^2*d^3*W^2 +
    60603210405/1019333404135424*X^2*d^2*W^3 -
    20201070135/509666702067712*X*d^3*W^3 +
    6733690045/1019333404135424*d^4*W^3),
X^6*d -
    2386450528484026739/59122909184*X^6*W +
    7159351408083352665/29561454592*X^5*d*W -
    21478054401618785547/59122909184*X^4*d^2*W -
    7159351319398988889/29561454592*X^4*d*W^2 +
    11932252346805587775/14780727296*X^3*d^2*W^2 -
    7159351319398988889/29561454592*X^2*d^3*W^2 -
    21478054401618785547/59122909184*X^2*d^2*W^3 +
    7159351408083352665/29561454592*X*d^3*W^3 -
    2386450528484026739/59122909184*d^4*W^3 + d^3*W^4]);

Dimension(S1);
Points(S1);
0
{@ (0 : 0 : 1), (1 : 1 : 1), (0 : 1 : 0), (1 : 0 : 0) @}

Second Scheme

function collect(f, i)
    R := Parent(f);
    K := BaseRing(R);
    n := Rank(R);

    // Check if i is within valid range (manual error handling)
    if i lt 1 or i gt n then
        error "Variable index out of bounds";
    end if;

    // Indices of the other variables
    others := [1..n];
    Remove(~others, i);

    // Create the coefficient ring with the other variables
    Snames := [Names(R)[j] : j in others];
    S := PolynomialRing(K, #others);
    AssignNames(~S, Snames);

    // Create the univariate ring over S for the i-th variable
    S1<y> := PolynomialRing(S);
    AssignNames(~S1, [Names(R)[i]]);

    // Define the homomorphism from R to S1
    hom_images := [];
    for j in [1..n] do
        if j eq i then
            Append(~hom_images, S1.1); // y (the i-th variable)
        else
            pos := Index(others, j);
            Append(~hom_images, S.pos); // Other variables mapped to S
        end if;
    end for;

    hom := hom< R -> S1 | hom_images >;

    // Map the polynomial to the new ring
    g := hom(f);
    return g, S1;
end function;

K := Rationals();
R<k, X, d, W> := PolynomialRing(K, 4);
f := X^6*d + 1/589693864237407281398939648*(67108864*k^2 - 1640870769462043721728*k + 10030182965591011168476046123771905)*X^6*W +
        1/294846932118703640699469824*(-201326592*k^2 + 4922612308386131165184*k - 30090550665854626217649982568134659)*X^5*d*W +
        1/589693864237407281398939648*(603979776*k^2 - 14767836925158393495552*k + 90271650228482285940728103507585033)*X^4*d^2*W +
        1/294846932118703640699469824*(201326592*k^2 - 4922612308386131165184*k + 30090551550395422573760904666544131)*X^4*d*W^2 +
        1/147423466059351820349734912*(-335544320*k^2 + 8204353847310218608640*k - 50150917776424377029416637613557765)*X^3*d^2*W^2 +
        1/294846932118703640699469824*(201326592*k^2 - 4922612308386131165184*k + 30090551550395422573760904666544131)*X^2*d^3*W^2 +
        1/589693864237407281398939648*(603979776*k^2 - 14767836925158393495552*k + 90271650228482285940728103507585033)*X^2*d^2*W^3 +
        1/294846932118703640699469824*(-201326592*k^2 + 4922612308386131165184*k - 30090550665854626217649982568134659)*X*d^3*W^3 +
        1/589693864237407281398939648*(67108864*k^2 - 1640870769462043721728*k + 10030182965591011168476046123771905)*d^4*W^3 + d^3*W^4;
// Collect terms with respect to x (first variable)
g, S1 := collect(f, 1);

// Output will be:
// (y + 3)*y^2 + (z)*y + 2*z
// Where y in S1 represents the original x variable
g, S1;

(8/70296986608196172881*X^6*W - 48/70296986608196172881*X^5*d*W +
    72/70296986608196172881*X^4*d^2*W + 48/70296986608196172881*X^4*d*W^2 -
    160/70296986608196172881*X^3*d^2*W^2 + 48/70296986608196172881*X^2*d^3*W^2 +
    72/70296986608196172881*X^2*d^2*W^3 - 48/70296986608196172881*X*d^3*W^3 +
    8/70296986608196172881*d^4*W^3)*k^2 + (-354547183/127416675516928*X^6*W +
    1063641549/63708337758464*X^5*d*W - 3190924647/127416675516928*X^4*d^2*W -
    1063641549/63708337758464*X^4*d*W^2 + 1772735915/31854168879232*X^3*d^2*W^2
    - 1063641549/63708337758464*X^2*d^3*W^2 -
    3190924647/127416675516928*X^2*d^2*W^3 + 1063641549/63708337758464*X*d^3*W^3
    - 354547183/127416675516928*d^4*W^3)*k + X^6*d +
    125703698252911905/7390363648*X^6*W - 377111116929826659/3695181824*X^5*d*W
    + 1131333328618389033/7390363648*X^4*d^2*W +
    377111128015372131/3695181824*X^4*d*W^2 -
    628518528216377765/1847590912*X^3*d^2*W^2 +
    377111128015372131/3695181824*X^2*d^3*W^2 +
    1131333328618389033/7390363648*X^2*d^2*W^3 -
    377111116929826659/3695181824*X*d^3*W^3 +
    125703698252911905/7390363648*d^4*W^3 + d^3*W^4
Univariate Polynomial Ring in k over Polynomial ring of rank 3 over Rational
    Field

P<X,d,W>:=ProjectiveSpace(Rationals(),2);
S2 := Scheme(P, [(8/70296986608196172881*X^6*W - 48/70296986608196172881*X^5*d*W +
    72/70296986608196172881*X^4*d^2*W + 48/70296986608196172881*X^4*d*W^2 -
    160/70296986608196172881*X^3*d^2*W^2 + 48/70296986608196172881*X^2*d^3*W^2 +
    72/70296986608196172881*X^2*d^2*W^3 - 48/70296986608196172881*X*d^3*W^3 +
    8/70296986608196172881*d^4*W^3),
 (-354547183/127416675516928*X^6*W +
    1063641549/63708337758464*X^5*d*W - 3190924647/127416675516928*X^4*d^2*W -
    1063641549/63708337758464*X^4*d*W^2 + 1772735915/31854168879232*X^3*d^2*W^2
    - 1063641549/63708337758464*X^2*d^3*W^2 -
    3190924647/127416675516928*X^2*d^2*W^3 + 1063641549/63708337758464*X*d^3*W^3
    - 354547183/127416675516928*d^4*W^3),
 X^6*d +
    125703698252911905/7390363648*X^6*W - 377111116929826659/3695181824*X^5*d*W
    + 1131333328618389033/7390363648*X^4*d^2*W +
    377111128015372131/3695181824*X^4*d*W^2 -
    628518528216377765/1847590912*X^3*d^2*W^2 +
    377111128015372131/3695181824*X^2*d^3*W^2 +
    1131333328618389033/7390363648*X^2*d^2*W^3 -
    377111116929826659/3695181824*X*d^3*W^3 +
    125703698252911905/7390363648*d^4*W^3 + d^3*W^4

]);

Dimension(S2);
Points(S2);

0
{@ (0 : 0 : 1), (1 : 1 : 1), (0 : 1 : 0), (1 : 0 : 0) @}

Third Scheme

function collect(f, i)
    R := Parent(f);
    K := BaseRing(R);
    n := Rank(R);

    // Check if i is within valid range (manual error handling)
    if i lt 1 or i gt n then
        error "Variable index out of bounds";
    end if;

    // Indices of the other variables
    others := [1..n];
    Remove(~others, i);

    // Create the coefficient ring with the other variables
    Snames := [Names(R)[j] : j in others];
    S := PolynomialRing(K, #others);
    AssignNames(~S, Snames);

    // Create the univariate ring over S for the i-th variable
    S1<y> := PolynomialRing(S);
    AssignNames(~S1, [Names(R)[i]]);

    // Define the homomorphism from R to S1
    hom_images := [];
    for j in [1..n] do
        if j eq i then
            Append(~hom_images, S1.1); // y (the i-th variable)
        else
            pos := Index(others, j);
            Append(~hom_images, S.pos); // Other variables mapped to S
        end if;
    end for;

    hom := hom< R -> S1 | hom_images >;

    // Map the polynomial to the new ring
    g := hom(f);
    return g, S1;
end function;

K := Rationals();
R<k, X, d, W> := PolynomialRing(K, 4);
f := X^6*d + 1/4717550913899258251191517184*(738197504*k^2 - 18037052895212464848896*k + 110178931418715457915654174362980363)*X^6*W +
        1/2358775456949629125595758592*(-2214592512*k^2 + 54111158685637394546688*k - 330536808408799115444737276663492641)*X^5*d*W +
        1/4717550913899258251191517184*(6643777536*k^2 - 162333476056912183640064*k + 991610411073744604636437076415926371)*X^4*d^2*W +
        1/2358775456949629125595758592*(2214592512*k^2 - 54111158685637394546688*k + 330536815485125486293624653450768417)*X^4*d*W^2 +
        1/1179387728474814562797879296*(-3690987520*k^2 + 90185264476062324244480*k - 550894680681331859074562127772487735)*X^3*d^2*W^2 +
        1/2358775456949629125595758592*(2214592512*k^2 - 54111158685637394546688*k + 330536815485125486293624653450768417)*X^2*d^3*W^2 +
        1/4717550913899258251191517184*(6643777536*k^2 - 162333476056912183640064*k + 991610411073744604636437076415926371)*X^2*d^2*W^3 +
        1/2358775456949629125595758592*(-2214592512*k^2 + 54111158685637394546688*k - 330536808408799115444737276663492641)*X*d^3*W^3 +
        1/4717550913899258251191517184*(738197504*k^2 - 18037052895212464848896*k + 110178931418715457915654174362980363)*d^4*W^3 + d^3*W^4;
// Collect terms with respect to x (first variable)
g, S1 := collect(f, 1);

// Output will be:
// (y + 3)*y^2 + (z)*y + 2*z
// Where y in S1 represents the original x variable
g, S1;

(11/70296986608196172881*X^6*W - 66/70296986608196172881*X^5*d*W +
    99/70296986608196172881*X^4*d^2*W + 66/70296986608196172881*X^4*d*W^2 -
    220/70296986608196172881*X^3*d^2*W^2 + 66/70296986608196172881*X^2*d^3*W^2 +
    99/70296986608196172881*X^2*d^2*W^3 - 66/70296986608196172881*X*d^3*W^3 +
    11/70296986608196172881*d^4*W^3)*k^2 + (-3897312581/1019333404135424*X^6*W +
    11691937743/509666702067712*X^5*d*W - 35075813229/1019333404135424*X^4*d^2*\
    W - 11691937743/509666702067712*X^4*d*W^2 +
    19486562905/254833351033856*X^3*d^2*W^2 -
    11691937743/509666702067712*X^2*d^3*W^2 -
    35075813229/1019333404135424*X^2*d^2*W^3 +
    11691937743/509666702067712*X*d^3*W^3 -
    3897312581/1019333404135424*d^4*W^3)*k + X^6*d +
    1380822184041824363/59122909184*X^6*W -
    4142466729494200641/29561454592*X^5*d*W +
    12427400011113874371/59122909184*X^4*d^2*W +
    4142466818178564417/29561454592*X^4*d*W^2 -
    6904111215823667735/14780727296*X^3*d^2*W^2 +
    4142466818178564417/29561454592*X^2*d^3*W^2 +
    12427400011113874371/59122909184*X^2*d^2*W^3 -
    4142466729494200641/29561454592*X*d^3*W^3 +
    1380822184041824363/59122909184*d^4*W^3 + d^3*W^4
Univariate Polynomial Ring in k over Polynomial ring of rank 3 over Rational
    Field

P<X,d,W>:=ProjectiveSpace(Rationals(),2);
S3 := Scheme(P, [(11/70296986608196172881*X^6*W - 66/70296986608196172881*X^5*d*W +
    99/70296986608196172881*X^4*d^2*W + 66/70296986608196172881*X^4*d*W^2 -
    220/70296986608196172881*X^3*d^2*W^2 + 66/70296986608196172881*X^2*d^3*W^2 +
    99/70296986608196172881*X^2*d^2*W^3 - 66/70296986608196172881*X*d^3*W^3 +
    11/70296986608196172881*d^4*W^3),
(-3897312581/1019333404135424*X^6*W +
    11691937743/509666702067712*X^5*d*W - 35075813229/1019333404135424*X^4*d^2*\
    W - 11691937743/509666702067712*X^4*d*W^2 +
    19486562905/254833351033856*X^3*d^2*W^2 -
    11691937743/509666702067712*X^2*d^3*W^2 -
    35075813229/1019333404135424*X^2*d^2*W^3 +
    11691937743/509666702067712*X*d^3*W^3 -
    3897312581/1019333404135424*d^4*W^3),
 X^6*d +
    1380822184041824363/59122909184*X^6*W -
    4142466729494200641/29561454592*X^5*d*W +
    12427400011113874371/59122909184*X^4*d^2*W +
    4142466818178564417/29561454592*X^4*d*W^2 -
    6904111215823667735/14780727296*X^3*d^2*W^2 +
    4142466818178564417/29561454592*X^2*d^3*W^2 +
    12427400011113874371/59122909184*X^2*d^2*W^3 -
    4142466729494200641/29561454592*X*d^3*W^3 +
    1380822184041824363/59122909184*d^4*W^3 + d^3*W^4

]);

Dimension(S3);
Points(S3);

0
{@ (0 : 0 : 1), (1 : 1 : 1), (0 : 1 : 0), (1 : 0 : 0) @}
